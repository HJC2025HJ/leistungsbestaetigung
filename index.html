<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leistungsbestätigung</title>

<style>
*{box-sizing:border-box}
body{
margin:0;
padding:16px;
font-family:Arial,Helvetica,sans-serif;
background:#eef2f3;
}

.container{
max-width:1100px;
margin:auto;
background:#fff;
border-radius:14px;
padding:22px;
position:relative;
overflow:hidden;
}

.watermark{
position:absolute;
inset:0;
background:url("HJ_Clean.png") center/65% no-repeat;
opacity:0.12;
pointer-events:none;
}

.content{position:relative;z-index:1}

h1{text-align:center;margin:20px 0}

.section-title{
margin-top:22px;
font-weight:bold;
border-left:5px solid #22c55e;
padding-left:10px;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:14px;
margin-top:12px;
}

.field label{
display:block;
font-size:13px;
margin-bottom:4px;
font-weight:600;
}

.field input,.field select{
width:100%;
padding:9px;
border-radius:8px;
border:1px solid #ccc;
font-size:14px;
}

.employee-list label{
display:flex;
align-items:center;
gap:6px;
margin:6px 0;
}

.time-grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:16px;
}

.time-box{
border:1px solid #ddd;
border-radius:10px;
padding:10px;
}

.signatures{
display:grid;
grid-template-columns:1fr 1fr;
gap:16px;
margin-top:18px;
}

canvas{
width:100%;
height:150px;
border:2px dashed #999;
border-radius:8px;
background:#fff;
touch-action:none;
}

.sig-actions{
margin-top:6px;
display:flex;
gap:8px;
}

button{
padding:9px 14px;
border:none;
border-radius:8px;
cursor:pointer;
color:#fff;
}

.confirm{background:#22c55e}
.delete{background:#ef4444}
.print{
margin-top:22px;
width:100%;
background:#2563eb;
font-size:16px;
}

/* ===== TEXTE POUR PDF ===== */
.print-value{
display:none;
font-size:14px;
margin-top:4px;
}

/* ===== PRINT PRO ===== */
@media print{
@page{size:A4;margin:10mm;}

body{background:#fff;padding:0;}
.container{
width:100%;
padding:0;
border-radius:0;
}

input,select,button,.sig-actions{
display:none!important;
}

.print-value{
display:block!important;
}

canvas{
height:85px!important;
border:none;
}

.signatures{
gap:10px;
}

.section-title{
margin-top:14px;
}
}
</style>
</head>

<body>
<div class="container">
<div class="watermark"></div>

<div class="content">

<h1>Leistungsbestätigung</h1>

<div class="section-title">Mitarbeiter</div>
<div class="employee-list">
<label><input type="checkbox" class="emp"> Hervé Mbarga</label>
<label><input type="checkbox" class="emp"> Jacky Massing</label>
<div class="print-value" id="p-emp"></div>
</div>

<div class="section-title">Kunde</div>
<div class="grid">
<div class="field"><label>Vorname</label><input id="vn"><div class="print-value" id="p-vn"></div></div>
<div class="field"><label>Nachname</label><input id="nn"><div class="print-value" id="p-nn"></div></div>
<div class="field"><label>Telefon</label><input id="tel"><div class="print-value" id="p-tel"></div></div>
<div class="field"><label>Anschrift</label><input id="adr"><div class="print-value" id="p-adr"></div></div>
</div>

<div class="section-title">Datum & Zeit</div>
<div class="grid">
<div class="field"><label>Datum</label><input type="date" id="date"><div class="print-value" id="p-date"></div></div>
</div>

<div class="time-grid">
<div class="time-box">
<strong>Beginn</strong>
<div class="grid">
<div class="field"><label>Stunde</label><select id="sh"></select></div>
<div class="field"><label>Minute</label><select id="sm"></select></div>
</div>
</div>
<div class="time-box">
<strong>Ende</strong>
<div class="grid">
<div class="field"><label>Stunde</label><select id="eh"></select></div>
<div class="field"><label>Minute</label><select id="em"></select></div>
</div>
</div>
</div>

<div class="section-title">Berechnung</div>
<div class="grid">
<div class="field"><label>Anzahl Mitarbeiter</label><input id="empCount" readonly><div class="print-value" id="p-empCount"></div></div>
<div class="field"><label>Arbeitsstunden</label><input id="hours" readonly><div class="print-value" id="p-hours"></div></div>
<div class="field"><label>€/Stunde</label><input id="rate" value="25"><div class="print-value" id="p-rate"></div></div>
<div class="field"><label>Kilometer</label><input id="km" value="0"><div class="print-value" id="p-km"></div></div>
<div class="field"><label>€/km</label><input id="kmrate" value="0.30"><div class="print-value" id="p-kmrate"></div></div>
<div class="field"><label>Gesamtbetrag €</label><input id="total" readonly><div class="print-value" id="p-total"></div></div>
</div>

<div class="section-title">Unterschriften</div>
<div class="signatures">
<div>
<strong>Kunde</strong>
<canvas id="sigK"></canvas>
</div>
<div>
<strong>Mitarbeiter</strong>
<canvas id="sigM"></canvas>
</div>
</div>

<button class="print" onclick="window.print()">Als PDF speichern / drucken</button>

</div>
</div>

<script>
function fill(s,m){for(let i=0;i<=m;i++){let o=document.createElement("option");o.value=o.text=String(i).padStart(2,"0");s.add(o)}}
fill(sh,23);fill(eh,23);fill(sm,59);fill(em,59);

function calc(){
const emp=document.querySelectorAll(".emp:checked").length;
empCount.value=emp;
const start=Number(sh.value)+Number(sm.value)/60;
const end=Number(eh.value)+Number(em.value)/60;
const base=Math.max(end-start,0);
hours.value=(base*emp).toFixed(2);
total.value=((hours.value*rate.value)+(km.value*kmrate.value)).toFixed(2);
}
document.querySelectorAll("input,select").forEach(e=>e.addEventListener("input",calc));

function sig(c){
const ctx=c.getContext("2d");let d=false;
c.onpointerdown=e=>{d=true;ctx.beginPath();ctx.moveTo(e.offsetX,e.offsetY);}
c.onpointermove=e=>{if(d){ctx.lineWidth=2;ctx.lineTo(e.offsetX,e.offsetY);ctx.stroke();}}
c.onpointerup=()=>d=false;
}
sig(sigK);sig(sigM);

window.addEventListener("beforeprint",()=>{
p-vn.textContent=vn.value;
p-nn.textContent=nn.value;
p-tel.textContent=tel.value;
p-adr.textContent=adr.value;
p-date.textContent=date.value;
p-emp.textContent=[...document.querySelectorAll(".emp:checked")].map(e=>e.parentNode.textContent).join(", ");
p-empCount.textContent=empCount.value;
p-hours.textContent=hours.value;
p-rate.textContent=rate.value+" €";
p-km.textContent=km.value;
p-kmrate.textContent=kmrate.value+" €";
p-total.textContent=total.value+" €";
});
</script>

</body>
</html>
